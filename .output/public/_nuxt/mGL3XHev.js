import{r as d,c,u as r,a as s,x as f,y as m,z as p,q as h,t as $,F as V,o as b}from"./BXZJvgDu.js";import{u as z}from"./BuRCZMhK.js";import{u as G}from"./DnVFLJUG.js";const S=""+new URL("user.CXthF0zB.png",import.meta.url).href,j={key:0},F={key:0,class:"max-w-80 mx-auto"},A={class:"mb-5"},B=s("label",{for:"email",class:"block mb-2 text-sm font-medium text-gray-900"},"Логин",-1),R={class:"mb-5"},q=s("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900"},"Пароль",-1),H={key:1,class:"max-w-80 mx-auto"},Q={class:"mb-5"},I=s("label",{for:"email",class:"block mb-2 text-sm font-medium text-gray-900"},"Логин",-1),N={class:"mb-5"},M=s("label",{class:"block mb-2 text-sm font-medium text-gray-900"},"Пароль",-1),X={key:1,class:"mx-auto max-w-80"},J={class:"w-full max-w-80 bg-white border border-gray-200 rounded-lg shadow"},K=s("div",{class:"flex justify-end px-4 pt-8"},null,-1),W={class:"flex flex-col items-center pb-10"},Y=s("img",{class:"w-24 h-24 mb-3 rounded-full shadow-lg",src:S},null,-1),Z={class:"mb-1 text-xl font-medium text-gray-900"},ee={key:0,class:"flex flex-col items-center"},te={class:"text-sm text-gray-500"},se={class:"text-sm text-gray-500"},oe={class:"text-sm text-gray-500"},le={class:"flex mt-4 md:mt-6"},re={key:1},ne={class:"mb-6"},ae=s("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-900"},"Новый пароль",-1),ue={class:"mb-6"},de=s("label",{class:"block mb-2 text-sm font-medium text-gray-900"},"Повторите пароль",-1),fe={__name:"login",setup(ie){const o=z(),D=G(),w=d(1),i=d(),x=d();async function T(){const l=await $fetch("https://dexone.ru/backend_shop/users",{method:"GET"});console.log(l);let t=[];for(let e=0;e<l.length;e++)t.push(l[e].login);if(t.includes(i.value)==!1){let e=l[l.length-1].id+1;await $fetch("https://dexone.ru/backend_shop/users",{method:"POST",body:{id:e,login:i.value,pass:x.value}}),await $fetch("https://dexone.ru/backend_shop/users",{method:"GET"}),o.user=e,await $fetch("https://dexone.ru/backend_shop/cart",{method:"POST",body:{id:e,carts:{}}}),await $fetch("https://dexone.ru/backend_shop/favourite",{method:"POST",body:{id:e,favourites:{}}}),o.name=i.value,E()}else alert("Пользователь с таким логином уже существует"),i.value="",x.value=""}const g=d(),y=d();async function C(){const l=await $fetch("https://dexone.ru/backend_shop/users",{method:"GET"});let t=[],e=[];for(let u=0;u<l.length;u++)t.push(l[u].login),e.push(l[u].pass);let n=t.indexOf(g.value);n>0&&y.value==e[n]?(o.user=n+1,o.name=g.value,E()):(alert("неверный логин или пароль"),o.user=1,g.value="",y.value="")}const k=d(!1),v=d(),_=d();async function P(){if(await $fetch(`https://dexone.ru/backend_shop/users/${o.user}`,{method:"GET"}),v.value==_.value){await $fetch(`https://dexone.ru/backend_shop/users/${o.user}`,{method:"PATCH",body:{pass:v.value}});const l=await fetch(`https://dexone.ru/backend_shop/cart/${o.user}`,{method:"GET"});console.log(l),alert("Успешно")}else alert("Пароли не совпадают")}async function L(){await $fetch(`https://dexone.ru/backend_shop/users/${o.user}`,{method:"DELETE"}),await $fetch(`https://dexone.ru/backend_shop/cart/${o.user}`,{method:"DELETE"}),await $fetch(`https://dexone.ru/backend_shop/favourite/${o.user}`,{method:"DELETE"}),o.user=1,o.editQuantity()}async function E(){let l=o.cart,e=(await $fetch(`https://dexone.ru/backend_shop/cart/${o.user}`,{method:"GET"})).carts,n=Object.keys(l),u=Object.keys(e);for(let a=0;a<n.length;a++)u.includes(n[a])==!0?console.log("Ничего не делать"):e[n[a]]=l[n[a]];await $fetch(`https://dexone.ru/backend_shop/cart/${o.user}`,{method:"PATCH",body:{carts:e}}),o.cart={},O()}async function O(){let l=D.favourite,e=(await $fetch(`https://dexone.ru/backend_shop/favourite/${o.user}`,{method:"GET"})).favourites,n=Object.keys(l),u=Object.keys(e);for(let a=0;a<n.length;a++)u.includes(n[a])==!0?console.log("Ничего не делать"):e[n[a]]=l[n[a]];await $fetch(`https://dexone.ru/backend_shop/favourite/${o.user}`,{method:"PATCH",body:{favourites:e}}),D.favourite={},o.editQuantity()}return(l,t)=>(b(),c(V,null,[r(o).user==1?(b(),c("div",j,[r(w)==1?(b(),c("div",F,[s("div",A,[B,f(s("input",{placeholder:"Dexone","onUpdate:modelValue":t[0]||(t[0]=e=>p(i)?i.value=e:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[m,r(i)]])]),s("div",R,[q,f(s("input",{placeholder:"•••••••••","onUpdate:modelValue":t[1]||(t[1]=e=>p(x)?x.value=e:null),type:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[m,r(x)]])]),s("button",{onClick:t[2]||(t[2]=e=>T()),class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center"}," Зарегистрироваться "),s("button",{onClick:t[3]||(t[3]=e=>w.value=2),class:"ml-3 text-gray-700"},"Уже есть аккаунт?")])):h("",!0),r(w)==2?(b(),c("div",H,[s("div",Q,[I,f(s("input",{placeholder:"Dexone","onUpdate:modelValue":t[4]||(t[4]=e=>p(g)?g.value=e:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[m,r(g)]])]),s("div",N,[M,f(s("input",{placeholder:"•••••••••","onUpdate:modelValue":t[5]||(t[5]=e=>p(y)?y.value=e:null),type:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[m,r(y)]])]),s("button",{onClick:t[6]||(t[6]=e=>C()),class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center"}," Войти "),s("button",{onClick:t[7]||(t[7]=e=>w.value=1),class:"ml-3 text-gray-700"},"У меня нет аккаунта")])):h("",!0)])):h("",!0),r(o).user>1?(b(),c("div",X,[s("div",J,[K,s("div",W,[Y,s("h5",Z,$(r(o).name),1),r(k)==!1?(b(),c("div",ee,[s("span",te,"ID аккаунта: "+$(r(o).user),1),s("span",se,"Товаров в корзине: "+$(r(o).quantity[0]),1),s("span",oe,"Сумма товаров: "+$(r(o).quantity[1]),1),s("div",le,[s("button",{onClick:t[8]||(t[8]=e=>(r(o).user=1,r(o).editQuantity())),class:"inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300"}," Выйти "),s("button",{onClick:t[9]||(t[9]=e=>k.value=!0),class:"py-2 px-4 ms-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100"}," Сменить пароль ")]),s("button",{onClick:t[10]||(t[10]=e=>L()),class:"py-2 px-14 mt-2 text-sm font-medium focus:outline-none bg-red-50 rounded-lg border border-red-500 text-red-700 hover:bg-red-150 hover:text-red-900 focus:z-10 focus:ring-4 focus:ring-gray-100"}," Удалить аккаунт ")])):h("",!0),r(k)==!0?(b(),c("div",re,[s("div",ne,[ae,f(s("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>p(v)?v.value=e:null),type:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700",placeholder:"•••••••••"},null,512),[[m,r(v)]])]),s("div",ue,[de,f(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>p(_)?_.value=e:null),type:"password",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"•••••••••"},null,512),[[m,r(_)]])]),s("button",{onClick:t[13]||(t[13]=e=>k.value=!1),class:"inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300"}," Назад "),s("button",{onClick:t[14]||(t[14]=e=>P()),class:"py-2 px-4 ms-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100"}," Сменить пароль ")])):h("",!0)])])])):h("",!0)],64))}};export{fe as default};
